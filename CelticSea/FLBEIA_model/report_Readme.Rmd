Rmarkdown for WGMIXFISH Celtic Seas ecoregion advice sheet and reporting
========================================================================

This folder contains the Rmarkdown material required for the generation of an annual advice sheet and report for the Celtic seas ecoregion.

Structure of this folder
------------------------

This folder contains the following sub-directories:

 - [**`1_Data/`**](1_Data/): containing model outputs in a standardised csv format to be read into the ...
 - [**`figures/`**](figures/): containing figures and associated captions produced by the ... script to be read into the final advice and report documents.
 - [**`tables/`**](tables/): containing the figures and associated captions produced by ... script to be read into the final advice and report documents.
 - [**`funcs/`**](funcs/): containing R scripts with functions to generate tables and figures. Namely:
   - [`funcs/figures_tables_functions.R`](funcs/figures_tables_functions.R) for processing model outputs within [`1_Data/`](1_Data/) into figures and tables

Using this folder
-----------------

Ensure that the required final model outputs are in the correct format within [`1_Data/`](1_Data/).
Run [`report_01_figures_tables_generate.R`](report_01_figures_tables_generate.R) to generate the required figures and tables and check that these are correct. 
Then, run [`report_01_advice.Rmd`](report_01_advice.Rmd) to generate a word document (*.docx) containing the formatted figures and tables for the Celtic seas ecoregion advice sheet and report.

Progress summary
----------------

Several plotting and tabulation functions have been defined within [`funcs/figures_tables_functions.R`](funcs/figures_tables_functions.R). Plotting functions are:

 - **underOverPlot**: Function to plot estimates of potential catches of stock given mixed fishery scenarios. Function is working - plotted values appear to be correct and function is flexible enough to accommodate variable scenarios and stocks. Some aesthetic issues (y-axis lower bounds not working well) and need to better document function arguments.
 - **plotEffortLim**: Function to plot the effort required by fleets to reach single-stock advice. Unclear whether the calculations used here are sensible - effort required to achieve single stock advice catches for each stock is estimated based on CPUE calculated from the fixed effort scenario.
 - **plotScenSBB**: Function to plot estimated scenario SSB expressed as ratio to single-stock advice forecast. Function works well, potentially some additional error checking capability would be nice. Some additional documentation needed.
 - **plotMetierLandings**: Function to plot the landings distribution of species by metier. Currently, the category "OTH" catches gears labelled "Other". This differs from the report figure where: "The “other” (OTH) displayed here is a mixed category consisting of (i) landings without corresponding effort and (ii) landings of any combination of fleet and métier with landings < 1% of any of the stocks (Table 4) in 2019." Need to follow up on this. Some additional documentation needed.
 - **plotPieLandings**: Function to plot the total landings by stock for the last data year in the form of a pie chart. Function works well, but aesthetic improvements needed to optimise space usage. Some additional documentation also needed.
 
Tabulation functions are:

 - **tableNomfun**: Function to generate table on nomenclature that is used in the advice and reporting documents. Function is not operational.
 - **tableSSB**: Function to generate table for SSB from single stock advice and mixed fishery scenarios. Function works well - documentation should be sufficient.
 - **tableCatch**: Function to generate table for catch from single stock advice and mixed fishery scenarios. Function works well - documentation should be sufficient.
 - **tableFbar**: Function to generate table for mean fishing mortality from single stock advice and mixed fishery scenarios. Function works well - documentation should be sufficient.
 - **tableRelCatch**: Function to generate table showing estimated catch in each scenario relative to single stock advice. Function works well - some additional documentation required.
 - **tableStockAdvice**: Function is not operational.

Tables and figures are generated by [`report_01_figures_tables_generate.R`](report_01_figures_tables_generate.R). Data read-in and processed are currently placeholders for testing purposes so some additional editing may be required for the "true" data set.

[`report_01_advice.Rmd`](report_01_advice.Rmd) is currently the workhorse for collating figures and tables. This script should be edited to retain only material relevant for the advice sheet, with appropriated material being migrated or copied to [`report_02_WGreport.Rmd`](report_02_WGreport.Rmd)

Additional missing functionality:

 - Tables handling range scenarios.
 - A figure plotting range scenarios.
 - Auto-generated explanatory text for figures and tables in generated reports
 - Cross-referencing within figure and table captions.